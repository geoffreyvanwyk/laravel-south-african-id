![Repository Bannner](https://banners.beyondco.de/South%20African%20ID%20for%20Laravel.png?theme=light&packageManager=composer+require&packageName=geoffreyvanwyk%2Flaravel-south-african-id&pattern=anchorsAway&style=style_1&description=A+value+object%2C+cast+and+validator+for+a+South+African+identity+number&md=1&showWatermark=1&fontSize=100px&images=https%3A%2F%2Flaravel.com%2Fimg%2Flogomark.min.svg) <!-- markdownlint-disable-line first-line-h1 -->

[![Latest Version on Packagist](https://img.shields.io/packagist/v/geoffreyvanwyk/laravel-south-african-id.svg?style=flat-square)](https://packagist.org/packages/geoffreyvanwyk/laravel-south-african-id)
[![GitHub Tests Action Status](https://img.shields.io/github/actions/workflow/status/geoffreyvanwyk/laravel-south-african-id/run-tests.yml?branch=main&label=tests&style=flat-square)](https://github.com/geoffreyvanwyk/laravel-south-african-id/actions?query=workflow%3Arun-tests+branch%3Amain)
[![GitHub Code Style Action Status](https://img.shields.io/github/actions/workflow/status/geoffreyvanwyk/laravel-south-african-id/fix-php-code-style-issues.yml?branch=main&label=code%20style&style=flat-square)](https://github.com/geoffreyvanwyk/laravel-south-african-id/actions?query=workflow%3A"Fix+PHP+code+style+issues"+branch%3Amain)
[![Total Downloads](https://img.shields.io/packagist/dt/geoffreyvanwyk/laravel-south-african-id.svg?style=flat-square)](https://packagist.org/packages/geoffreyvanwyk/laravel-south-african-id)

# South African ID for Laravel

A self-validating value object, type cast, and validator for a South African
government-issued personal [identification number](https://www.westerncape.gov.za/general-publication/decoding-your-south-african-id-number-0),
for Laravel. The package also includes a validator that checks whether a date
matches the South African ID.

The validator will pass values generated by the Faker
[idNumber](https://fakerphp.org/locales/en_ZA/#fakerprovideren_zaperson)
formatter that is part of the English (South Africa) or `en_ZA` locale.

## Install

Use [Composer](https://getcomposer.org) to install the package.

```shell
composer require geoffreyvanwyk/laravel-south-african-id
```

## Usage

### Value Object

The value object can be instantiated by passing a string to its constructor.

```php
use Kokerboom\Laravel\ValueObjects\SouthAfricanId;

$idNumber = new SouthAfricanId('9308062469083');
```

If the string argument is not in the valid format, a subclass of the
`ArgumentException`, indicative of the type of error, will be thrown.

Useful information encoded in the identity number can be extracted, for example:

```php
$idNumber->isFemale();
$idNumber->isMale();
$idNumber->isCitizen();
$idNumber->isPermanentResident();
$idNumber->birthMonth();
$idNumber->birthDay();
```

### Cast

An attribute of an
[Eloquent](https://laravel.com/docs/11.x/eloquent#generating-model-classes)
model can be cast to an instance of the South African ID
value object.

```php
use Kokerboom\Laravel\Casts\AsSouthAfricanId;

/**
 * Get the attributes that should be cast.
 *
 * @return array<string, string>
 */
protected function casts(): array
{
    return [
        'south_african_id' => AsSouthAfricanId::class,
    ];
}
```

### Validators

A value submitted in a request can be validated to be a South African ID.

```php
use Kokerboom\Laravel\Rules\SouthAfricanId;

$request->validate([
    'id_number' => ['required', 'string', new SouthAfricanId()],
]);
```

If the request also contains a birth date field, that field can be validated to
match the South African ID using the `BirthDateMatchSouthAfricanId` rule. In
this case, the field containing the South African ID, must be named
`south_african_id`.

```php
use Kokerboom\Laravel\Rules\BirthDateMatchSouthAfricanId;
use Kokerboom\Laravel\Rules\SouthAfricanId;

$request->validate([
    'south_african_id' => ['required', 'string', new SouthAfricanId()],
    'birth_date' => [
        'date_format:Y-m-d',
        'before_or_equal:today',
        new BirthDateMatchSouthAfricanId()
    ],
]);
```

## License

Copyright &copy; 2024 Geoffrey Bernardo van Wyk [https://geoffreyvanwyk.dev](https://geoffreyvanwyk.dev)

This file is part of package geoffreyvanwyk/laravel-south-african-id.

Package geoffreyvanwyk/laravel-south-african-id is free software: you can redistribute it
and/or modify it under the terms of the GNU General Public License as
published by the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

Package geoffreyvanwyk/laravel-south-african-id is distributed in the hope that it will be
useful, but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General
Public License for more details.

You should have received a copy of the GNU General Public License along with
package geoffreyvanwyk/laravel-south-african-id. If not, see <https://www.gnu.org/licenses/>.
